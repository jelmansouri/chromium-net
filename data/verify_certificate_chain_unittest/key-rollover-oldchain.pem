[Created by: generate-key-rollover.py]

A certificate tree with two self-signed root certificates(oldroot, newroot),
and a third root certificate (newrootrollover) which has the same key as newroot
but is signed by oldroot, all with the same subject and issuer.
There are two intermediates with the same key, subject and issuer
(oldintermediate signed by oldroot, and newintermediate signed by newroot).
The target certificate is signed by the intermediate key.


In graphical form:

   oldroot-------->newrootrollover  newroot
      |                      |        |
      v                      v        v
oldintermediate           newintermediate
      |                          |
      +------------+-------------+
                   |
                   v
                 target


Several chains are output:
  key-rollover-oldchain.pem:
    target<-oldintermediate<-oldroot
  key-rollover-rolloverchain.pem:
    target<-newintermediate<-newrootrollover<-oldroot
  key-rollover-longrolloverchain.pem:
    target<-newintermediate<-newroot<-newrootrollover<-oldroot
  key-rollover-newchain.pem:
    target<-newintermediate<-newroot

All of these chains should verify successfully.


Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1 (0x1)
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN=Intermediate
        Validity
            Not Before: Jan  1 12:00:00 2015 GMT
            Not After : Jan  1 12:00:00 2016 GMT
        Subject: CN=Target
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:ab:ca:16:55:35:25:9b:de:8e:fc:e9:5a:f9:04:
                    3e:0e:6c:06:1e:1c:86:20:18:4f:41:da:3a:6d:16:
                    9e:4e:3c:9b:11:67:bc:5a:3d:84:b2:79:05:d2:25:
                    9a:6a:a8:80:6c:55:28:f2:5a:43:5f:c5:ef:e9:e3:
                    1a:64:24:7e:57:4d:11:60:d7:e6:a9:2b:73:c7:93:
                    bb:67:b1:41:d5:df:21:5c:bd:98:93:a3:7d:0d:b0:
                    86:5f:87:a9:d9:ab:ad:97:89:c5:12:c4:0f:71:d3:
                    5b:79:18:53:64:7f:0a:a1:36:5e:00:5c:b9:ee:5e:
                    14:10:17:f2:2a:60:0f:f7:ec:aa:d7:ad:d3:dc:8a:
                    44:59:cf:c8:11:e7:42:1c:88:30:d7:1e:37:86:91:
                    6b:ce:2a:bc:bb:f5:4a:cc:72:1a:9d:4f:5f:0e:c4:
                    c5:f7:b6:24:09:1c:22:f8:f7:a2:3d:45:c2:29:4d:
                    a3:f3:db:7a:a4:93:a2:48:d6:2b:90:da:0c:2b:d9:
                    96:f0:d6:c7:eb:d0:eb:a8:08:72:55:a8:10:65:8f:
                    38:6a:22:0c:9c:3d:68:1a:cd:16:da:73:24:2e:14:
                    5d:08:05:fb:07:d1:52:53:4e:51:e4:b2:f3:17:4d:
                    f1:d0:c3:23:51:86:fb:a4:b9:09:37:9c:13:69:65:
                    51:45
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier: 
                90:8D:89:42:17:BF:F6:98:D1:AA:8C:BF:AF:C2:74:60:AB:ED:90:0F
            X509v3 Authority Key Identifier: 
                keyid:A5:25:8E:C3:14:9C:86:19:30:F5:05:C5:AA:C8:37:12:F6:94:4A:46

            Authority Information Access: 
                CA Issuers - URI:http://url-for-aia/Intermediate.cer

            X509v3 CRL Distribution Points: 

                Full Name:
                  URI:http://url-for-crl/Intermediate.crl

            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Extended Key Usage: 
                TLS Web Server Authentication, TLS Web Client Authentication
    Signature Algorithm: sha256WithRSAEncryption
         74:15:69:e0:48:a6:e3:fa:20:b6:3f:90:d7:61:d3:ea:b7:47:
         61:c7:81:6b:42:95:44:ac:1e:6f:3d:df:ad:2c:33:0d:e8:94:
         5b:d1:24:89:56:27:76:e4:6c:09:26:a7:e5:62:c9:96:83:ce:
         9d:08:f5:ee:c4:3d:fe:77:29:ae:8d:9f:7f:d5:81:b6:5d:b5:
         54:a0:1f:6c:54:1e:dd:a7:4e:78:e0:6c:60:1d:e8:1f:97:77:
         67:8d:57:80:00:17:80:cd:ab:ce:31:87:6e:9e:bf:3f:38:b9:
         da:96:a3:d2:22:63:43:dd:5c:e8:42:ea:2d:eb:ab:81:33:e5:
         95:36:46:3c:dd:8e:ad:e2:43:40:6f:3c:ce:73:4d:52:71:9d:
         54:59:f4:73:a2:5a:48:a5:c7:bc:dd:f9:9f:91:39:b1:bc:ad:
         9a:59:ea:f6:33:42:72:66:2f:e9:78:8f:b6:09:15:35:d8:e6:
         70:0d:d3:da:a7:7e:55:d9:05:88:47:16:1d:cd:54:1c:15:11:
         a6:d3:35:2a:4e:c5:0f:f7:b0:98:24:bf:7e:78:3e:5f:56:0c:
         87:72:c2:d1:7d:3e:3c:c6:98:50:a9:c7:cd:6f:0e:12:b4:32:
         7a:b8:01:6c:88:1c:8a:c2:19:24:1e:34:9b:da:45:eb:0a:f9:
         99:6e:54:c6
-----BEGIN CERTIFICATE-----
MIIDjTCCAnWgAwIBAgIBATANBgkqhkiG9w0BAQsFADAXMRUwEwYDVQQDDAxJbnRl
cm1lZGlhdGUwHhcNMTUwMTAxMTIwMDAwWhcNMTYwMTAxMTIwMDAwWjARMQ8wDQYD
VQQDDAZUYXJnZXQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCryhZV
NSWb3o786Vr5BD4ObAYeHIYgGE9B2jptFp5OPJsRZ7xaPYSyeQXSJZpqqIBsVSjy
WkNfxe/p4xpkJH5XTRFg1+apK3PHk7tnsUHV3yFcvZiTo30NsIZfh6nZq62XicUS
xA9x01t5GFNkfwqhNl4AXLnuXhQQF/IqYA/37KrXrdPcikRZz8gR50IciDDXHjeG
kWvOKry79UrMchqdT18OxMX3tiQJHCL496I9RcIpTaPz23qkk6JI1iuQ2gwr2Zbw
1sfr0OuoCHJVqBBljzhqIgycPWgazRbacyQuFF0IBfsH0VJTTlHksvMXTfHQwyNR
hvukuQk3nBNpZVFFAgMBAAGjgekwgeYwHQYDVR0OBBYEFJCNiUIXv/aY0aqMv6/C
dGCr7ZAPMB8GA1UdIwQYMBaAFKUljsMUnIYZMPUFxarINxL2lEpGMD8GCCsGAQUF
BwEBBDMwMTAvBggrBgEFBQcwAoYjaHR0cDovL3VybC1mb3ItYWlhL0ludGVybWVk
aWF0ZS5jZXIwNAYDVR0fBC0wKzApoCegJYYjaHR0cDovL3VybC1mb3ItY3JsL0lu
dGVybWVkaWF0ZS5jcmwwDgYDVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUF
BwMBBggrBgEFBQcDAjANBgkqhkiG9w0BAQsFAAOCAQEAdBVp4Eim4/ogtj+Q12HT
6rdHYceBa0KVRKwebz3frSwzDeiUW9EkiVYnduRsCSan5WLJloPOnQj17sQ9/ncp
ro2ff9WBtl21VKAfbFQe3adOeOBsYB3oH5d3Z41XgAAXgM2rzjGHbp6/Pzi52paj
0iJjQ91c6ELqLeurgTPllTZGPN2OreJDQG88znNNUnGdVFn0c6JaSKXHvN35n5E5
sbytmlnq9jNCcmYv6XiPtgkVNdjmcA3T2qd+VdkFiEcWHc1UHBURptM1Kk7FD/ew
mCS/fng+X1YMh3LC0X0+PMaYUKnHzW8OErQyergBbIgcisIZJB40m9pF6wr5mW5U
xg==
-----END CERTIFICATE-----

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 2 (0x2)
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN=Root
        Validity
            Not Before: Jan  1 12:00:00 2015 GMT
            Not After : Jan  1 12:00:00 2016 GMT
        Subject: CN=Intermediate
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:ad:d7:63:a2:51:33:32:fd:aa:73:2c:32:30:ac:
                    2f:8d:37:5f:08:b2:9b:02:1a:f7:3c:eb:c2:9e:82:
                    d9:a2:0e:02:14:28:bc:18:e2:92:8e:db:66:14:36:
                    3f:ef:43:47:ac:b4:e2:be:92:82:14:9a:bd:97:d7:
                    19:6f:88:29:b1:85:68:bd:13:d5:93:2c:a0:c8:bb:
                    76:9d:ad:f5:da:e8:55:ca:87:6d:07:20:f4:22:cf:
                    5a:51:ea:e1:7b:c3:7e:f9:a8:85:95:c5:e9:88:bf:
                    7b:5e:fd:49:d4:c4:ed:ce:b7:d2:71:23:59:00:a7:
                    6f:85:40:a0:38:c6:2b:88:99:68:e9:97:7e:2f:92:
                    97:18:0a:19:c2:4e:0a:28:2c:b3:b4:67:26:eb:1d:
                    03:f6:16:58:20:88:81:ee:a8:ea:19:ae:25:e9:34:
                    8d:87:f3:d2:3b:0e:b2:d8:31:14:ee:bd:c6:01:ec:
                    d4:41:f0:06:7b:3e:20:7b:06:88:86:29:d1:77:9a:
                    c0:bc:69:63:3f:2b:20:ac:aa:17:33:29:78:0a:11:
                    ff:92:f2:b3:4a:58:29:96:d3:f4:4f:70:ef:9c:81:
                    55:1c:21:20:bf:54:5a:dd:60:b7:6e:53:41:a2:19:
                    55:b5:f9:b8:6e:63:37:73:a0:b8:d4:c5:c1:a2:4e:
                    0e:11
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier: 
                A5:25:8E:C3:14:9C:86:19:30:F5:05:C5:AA:C8:37:12:F6:94:4A:46
            X509v3 Authority Key Identifier: 
                keyid:BE:C9:6B:AC:94:B5:1F:E4:8D:C6:90:9D:C0:D7:12:16:5E:50:47:16

            Authority Information Access: 
                CA Issuers - URI:http://url-for-aia/Root.cer

            X509v3 CRL Distribution Points: 

                Full Name:
                  URI:http://url-for-crl/Root.crl

            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
            X509v3 Basic Constraints: critical
                CA:TRUE
    Signature Algorithm: sha256WithRSAEncryption
         e0:0c:55:1f:da:4b:3e:e7:ec:e0:41:89:52:3d:0e:be:9d:31:
         1d:53:82:7a:99:d3:9d:35:65:97:4d:ba:67:c4:27:db:19:40:
         d9:0b:15:0d:6a:44:86:be:59:07:14:dc:1a:2c:94:41:2d:eb:
         70:be:c8:54:89:18:e7:27:fb:bb:4f:41:a6:60:70:1d:7f:bf:
         ea:87:01:df:7f:67:68:8a:8f:ff:89:89:b3:c0:95:a6:74:63:
         83:ba:b1:55:6d:1a:16:64:94:47:c2:6a:05:c2:62:eb:22:d5:
         ae:1a:a2:fb:93:0d:ca:a1:8a:39:32:25:97:a4:b2:72:73:7c:
         81:30:33:18:a4:fd:b6:e1:b6:6b:53:ac:26:31:ea:19:b6:d3:
         bb:31:6e:7a:91:01:e2:22:4a:f8:a5:38:9b:12:c6:e5:4a:bb:
         e4:49:35:59:07:1b:6a:25:58:b2:aa:04:02:90:fd:0a:55:cf:
         0e:1d:95:c6:d0:c1:c7:fa:a0:c4:e3:9e:75:58:f0:c6:63:d7:
         10:b3:ac:45:7e:60:86:cc:95:ab:7b:46:72:27:12:05:5d:ea:
         c8:09:47:b1:9a:6c:ef:d9:1a:0b:01:bb:6d:a4:f3:35:50:09:
         9a:86:68:a0:34:4c:7d:70:55:9d:88:d8:9a:3d:28:fb:8b:3c:
         53:96:8c:e9
-----BEGIN CERTIFICATE-----
MIIDbTCCAlWgAwIBAgIBAjANBgkqhkiG9w0BAQsFADAPMQ0wCwYDVQQDDARSb290
MB4XDTE1MDEwMTEyMDAwMFoXDTE2MDEwMTEyMDAwMFowFzEVMBMGA1UEAwwMSW50
ZXJtZWRpYXRlMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEArddjolEz
Mv2qcywyMKwvjTdfCLKbAhr3POvCnoLZog4CFCi8GOKSjttmFDY/70NHrLTivpKC
FJq9l9cZb4gpsYVovRPVkyygyLt2na312uhVyodtByD0Is9aUerhe8N++aiFlcXp
iL97Xv1J1MTtzrfScSNZAKdvhUCgOMYriJlo6Zd+L5KXGAoZwk4KKCyztGcm6x0D
9hZYIIiB7qjqGa4l6TSNh/PSOw6y2DEU7r3GAezUQfAGez4gewaIhinRd5rAvGlj
PysgrKoXMyl4ChH/kvKzSlgpltP0T3DvnIFVHCEgv1Ra3WC3blNBohlVtfm4bmM3
c6C41MXBok4OEQIDAQABo4HLMIHIMB0GA1UdDgQWBBSlJY7DFJyGGTD1BcWqyDcS
9pRKRjAfBgNVHSMEGDAWgBS+yWuslLUf5I3GkJ3A1xIWXlBHFjA3BggrBgEFBQcB
AQQrMCkwJwYIKwYBBQUHMAKGG2h0dHA6Ly91cmwtZm9yLWFpYS9Sb290LmNlcjAs
BgNVHR8EJTAjMCGgH6AdhhtodHRwOi8vdXJsLWZvci1jcmwvUm9vdC5jcmwwDgYD
VR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEB
AOAMVR/aSz7n7OBBiVI9Dr6dMR1TgnqZ0501ZZdNumfEJ9sZQNkLFQ1qRIa+WQcU
3BoslEEt63C+yFSJGOcn+7tPQaZgcB1/v+qHAd9/Z2iKj/+JibPAlaZ0Y4O6sVVt
GhZklEfCagXCYusi1a4aovuTDcqhijkyJZeksnJzfIEwMxik/bbhtmtTrCYx6hm2
07sxbnqRAeIiSvilOJsSxuVKu+RJNVkHG2olWLKqBAKQ/QpVzw4dlcbQwcf6oMTj
nnVY8MZj1xCzrEV+YIbMlat7RnInEgVd6sgJR7GabO/ZGgsBu22k8zVQCZqGaKA0
TH1wVZ2I2Jo9KPuLPFOWjOk=
-----END CERTIFICATE-----

Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 1 (0x1)
    Signature Algorithm: sha256WithRSAEncryption
        Issuer: CN=Root
        Validity
            Not Before: Jan  1 12:00:00 2015 GMT
            Not After : Jan  1 12:00:00 2016 GMT
        Subject: CN=Root
        Subject Public Key Info:
            Public Key Algorithm: rsaEncryption
                Public-Key: (2048 bit)
                Modulus:
                    00:ef:e6:e9:e0:b4:83:30:dc:21:a0:1f:9d:c3:81:
                    9d:a2:a1:ce:e5:ef:1f:94:e3:f0:14:05:12:2a:97:
                    5e:00:ba:6a:c3:09:b3:06:a1:9e:da:6f:9d:f8:45:
                    a2:6c:1e:7d:a3:10:d2:db:38:24:ed:80:25:36:9c:
                    db:d3:07:af:39:f8:82:48:a3:cd:7f:f3:57:dd:f9:
                    fd:7c:03:d5:8e:5d:35:ae:ed:af:c6:a1:89:ca:2e:
                    2e:cf:77:5a:26:c6:e4:1d:9d:97:c7:a7:cf:93:aa:
                    24:22:d9:82:d5:98:47:c9:33:ba:77:7e:6a:a3:35:
                    43:1c:56:a5:94:2d:48:0f:47:2d:33:cd:c4:46:2d:
                    54:61:dd:b8:bc:8d:1c:97:7d:4b:f4:fc:6b:3e:4d:
                    28:17:7f:9a:e9:e5:6d:6f:c4:1c:75:8d:a6:0d:b7:
                    5e:37:de:e1:1a:b2:e5:a6:d6:79:e4:df:1f:d3:f6:
                    68:ed:30:a3:9e:8d:ed:8b:55:3d:12:3f:0f:3f:90:
                    4f:b5:74:02:b0:1f:40:ae:32:d9:8e:a5:3b:74:e0:
                    f3:1e:4e:4c:63:fd:37:4b:b8:2f:70:41:64:4f:ee:
                    6b:2f:33:40:2f:8a:c6:5f:e3:6a:e4:a0:62:53:99:
                    de:8c:ca:b5:34:ca:c0:20:9e:16:73:13:e1:c9:dc:
                    22:b3
                Exponent: 65537 (0x10001)
        X509v3 extensions:
            X509v3 Subject Key Identifier: 
                BE:C9:6B:AC:94:B5:1F:E4:8D:C6:90:9D:C0:D7:12:16:5E:50:47:16
            X509v3 Authority Key Identifier: 
                keyid:BE:C9:6B:AC:94:B5:1F:E4:8D:C6:90:9D:C0:D7:12:16:5E:50:47:16

            Authority Information Access: 
                CA Issuers - URI:http://url-for-aia/Root.cer

            X509v3 CRL Distribution Points: 

                Full Name:
                  URI:http://url-for-crl/Root.crl

            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
            X509v3 Basic Constraints: critical
                CA:TRUE
    Signature Algorithm: sha256WithRSAEncryption
         0b:b4:ba:9b:02:15:72:58:48:09:c8:66:c4:7c:6e:07:5e:bf:
         e1:a5:97:42:fd:5f:8f:5f:35:e7:60:78:73:a8:18:f8:c2:91:
         b1:d4:1b:cb:11:17:e0:d5:30:69:90:b8:9a:f9:a1:95:47:c9:
         85:dd:6d:b9:56:a2:fb:16:2f:09:8c:c0:66:6d:af:7b:f2:42:
         67:0f:a3:b9:e8:69:36:89:92:1e:c8:54:11:fe:39:3f:71:85:
         d9:65:30:0c:2a:b1:a6:b8:df:b0:40:7b:56:98:3d:c3:66:76:
         be:85:ec:f2:6c:30:de:ce:b3:84:70:74:83:2b:20:42:5a:f0:
         9b:31:98:81:16:71:cf:cf:66:57:36:dd:13:cd:f0:74:0c:2f:
         a1:26:71:1e:50:ce:57:c9:85:71:47:08:b2:a6:b4:2a:2f:6b:
         5f:1f:80:09:3d:b1:5e:ab:aa:e7:08:86:c7:75:2d:36:b1:f3:
         2c:e1:91:8c:1c:6b:0a:fe:80:38:34:61:f8:a2:ee:3e:9a:e4:
         38:95:dd:3d:21:1e:61:5c:53:a7:30:b8:2b:10:72:d8:5d:54:
         a3:47:9c:6c:69:d6:42:a6:56:f2:b3:3e:98:22:c2:b0:6b:2e:
         f3:3a:b8:71:52:53:b5:32:a5:a4:38:35:fc:f2:ed:9a:e3:52:
         57:75:df:07
-----BEGIN TRUSTED_CERTIFICATE-----
MIIDZTCCAk2gAwIBAgIBATANBgkqhkiG9w0BAQsFADAPMQ0wCwYDVQQDDARSb290
MB4XDTE1MDEwMTEyMDAwMFoXDTE2MDEwMTEyMDAwMFowDzENMAsGA1UEAwwEUm9v
dDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAO/m6eC0gzDcIaAfncOB
naKhzuXvH5Tj8BQFEiqXXgC6asMJswahntpvnfhFomwefaMQ0ts4JO2AJTac29MH
rzn4gkijzX/zV935/XwD1Y5dNa7tr8ahicouLs93WibG5B2dl8enz5OqJCLZgtWY
R8kzund+aqM1QxxWpZQtSA9HLTPNxEYtVGHduLyNHJd9S/T8az5NKBd/munlbW/E
HHWNpg23Xjfe4Rqy5abWeeTfH9P2aO0wo56N7YtVPRI/Dz+QT7V0ArAfQK4y2Y6l
O3Tg8x5OTGP9N0u4L3BBZE/uay8zQC+Kxl/jauSgYlOZ3ozKtTTKwCCeFnMT4cnc
IrMCAwEAAaOByzCByDAdBgNVHQ4EFgQUvslrrJS1H+SNxpCdwNcSFl5QRxYwHwYD
VR0jBBgwFoAUvslrrJS1H+SNxpCdwNcSFl5QRxYwNwYIKwYBBQUHAQEEKzApMCcG
CCsGAQUFBzAChhtodHRwOi8vdXJsLWZvci1haWEvUm9vdC5jZXIwLAYDVR0fBCUw
IzAhoB+gHYYbaHR0cDovL3VybC1mb3ItY3JsL1Jvb3QuY3JsMA4GA1UdDwEB/wQE
AwIBBjAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUAA4IBAQALtLqbAhVy
WEgJyGbEfG4HXr/hpZdC/V+PXzXnYHhzqBj4wpGx1BvLERfg1TBpkLia+aGVR8mF
3W25VqL7Fi8JjMBmba978kJnD6O56Gk2iZIeyFQR/jk/cYXZZTAMKrGmuN+wQHtW
mD3DZna+hezybDDezrOEcHSDKyBCWvCbMZiBFnHPz2ZXNt0TzfB0DC+hJnEeUM5X
yYVxRwiyprQqL2tfH4AJPbFeq6rnCIbHdS02sfMs4ZGMHGsK/oA4NGH4ou4+muQ4
ld09IR5hXFOnMLgrEHLYXVSjR5xsadZCplbysz6YIsKway7zOrhxUlO1MqWkODX8
8u2a41JXdd8H
-----END TRUSTED_CERTIFICATE-----

-----BEGIN TIME-----
MTUwMzAyMTIwMDAwWg==
-----END TIME-----

-----BEGIN VERIFY_RESULT-----
U1VDQ0VTUw==
-----END VERIFY_RESULT-----
